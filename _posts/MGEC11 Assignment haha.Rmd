---
layout: post
title: a post with formatting and links
date: 2015-03-15 16:40:16
description: march & april, looking forward to summer
tags: formatting links
categories: sample-posts
---

#command/option/i
get the data file

```{r} 
library(readxl)
library(ggplot2)
library(dplyr)
library(stringr)
library(ggrepel)
```

```{r}
growth_data <- read_excel("2025-07-31 Assignment Data - Growth.xls")
growth_data
```

Q1: 
Construct a scatterplot of average annual growth rate (Growth) on the average trade
share (TradeShare). Does there appear to be a relationship between the variables?
```{r}
ggplot(growth_data, aes(x = tradeshare, y = growth)) + geom_point()
```

Q2: One country, Malta, has a trade share much larger than the other countries. Find
Malta on the scatterplot. Does Malta look like an outlier?
```{r}
ggplot(growth_data, aes(x = tradeshare, y = growth)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  geom_text(
    data = growth_data %>% filter(country_name == "Malta"),
    aes(label = country_name),
    vjust = 2
  )
```


Q3:Using all observations, run a regression of Growth on TradeShare. What is the
estimated slope? What is the estimated intercept? Use the regression to predict the
growth rate for a country with a trade share of 0.5 and with a trade share of 1.0.
```{r}
model <- lm(growth ~ tradeshare, data = growth_data)
summary(model)
```


```{r}
new_data <- data.frame(tradeshare = c(0.5, 1.0))
predicted_growth <- predict(model, newdata = new_data)
predicted_growth
named_preds <- setNames(predicted_growth, paste0("TS_", new_data$tradeshare))
named_preds
```
From the summary we know that the intercept is 0.6403 and the slope is 0.6403; and so our line of best fit is growth = 0.6403 + 2.3064 tradeshare. In particular, the estimated growth rate for a country with 0.5 tradeshare and 1 tradeshare respectively is 1.793482 and 2.946699. 

Q4: Estimate the same regression excluding the data from Malta. Answer the same
questions in Question 3 above. 

```{r}
model_wo_malta <- lm(growth ~ tradeshare, data = growth_data %>% filter(country_name != 'Malta'))
  summary(model_wo_malta)
```


```{r}
predicted_growth_wo_malta <- predict(model_wo_malta, newdata = new_data)
predicted_growth_wo_malta
named_preds_wo <- setNames(predicted_growth_wo_malta, paste0("TS_", new_data$tradeshare))
named_preds_wo
```
From the summary we know that the intercept is 0.9574 and the slope is 1.6809; and so our line of best fit without Malta  is growth = 0.9574 + 1.6809 tradeshare. In particular, the estimated growth rate for a country with 0.5 tradeshare and 1 tradeshare respectively is 1.797863 and 2.638315. 

Q5: Where is Malta? Why is Malta trade share so large? Should Malta be included or
excluded from the analysis? 
```{r}
##consider the standardized residual plot

model <- lm(growth ~ tradeshare, data = growth_data)
growth_data$resid_std <- rstandard(model)
ggplot(growth_data, aes(x = tradeshare, y = resid_std)) +
  geom_point() +
  geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
  geom_text_repel(
    data = growth_data %>% filter(abs(resid_std) > 2 | country_name == "Malta"),
    aes(label = country_name),
    max.overlaps = Inf
  ) +
  labs(
    y = "Standardized Residual",
    x = "Trade Share",
    title = "Standardized Residuals: Highlighting Outliers and Malta"
  ) +
  theme_minimal()
```

Use the data set Growth, but excluding the data for Malta, answer Questions 6â€“10. 
Q6: Construct a table that shows the sample mean, standard deviation, minimum and
maximum values for Growth, TradeShare, YearsSchool, Oil, Rev_Coups,
assasinations, RGDP60. Include the appropriate units for all entries.
```{r}
growth_new <- growth_data %>% 
  filter(country_name != 'Malta')


# Create the summary table
summary_table <- growth_new %>%
  summarise(
    `Growth (%/yr)`                = list(c(mean(growth, na.rm = TRUE),
                                            sd(growth, na.rm = TRUE),
                                            min(growth, na.rm = TRUE),
                                            max(growth, na.rm = TRUE))),
    `Trade Share ((X+M)/GDP)`      = list(c(mean(tradeshare, na.rm = TRUE),
                                            sd(tradeshare, na.rm = TRUE),
                                            min(tradeshare, na.rm = TRUE),
                                            max(tradeshare, na.rm = TRUE))),
    `Years of Schooling (years)`  = list(c(mean(yearsschool, na.rm = TRUE),
                                            sd(yearsschool, na.rm = TRUE),
                                            min(yearsschool, na.rm = TRUE),
                                            max(yearsschool, na.rm = TRUE))),
    `Oil Producer (0 = no/1 = yes)`          = list(c(mean(oil, na.rm = TRUE),
                                            sd(oil, na.rm = TRUE),
                                            min(oil, na.rm = TRUE),
                                            max(oil, na.rm = TRUE))),
    `Revolutionary Coups (avg. annual count)` = list(c(mean(rev_coups, na.rm = TRUE),
                                            sd(rev_coups, na.rm = TRUE),
                                            min(rev_coups, na.rm = TRUE),
                                            max(rev_coups, na.rm = TRUE))),
    `Assasinations (/million pop)` = list(c(mean(assasinations, na.rm = TRUE),
                                              sd(assasinations, na.rm = TRUE),
                                              min(assasinations, na.rm = TRUE),
                                              max(assasinations, na.rm = TRUE))),
    `RGDP in 1960 (USD)`            = list(c(mean(rgdp60, na.rm = TRUE),
                                            sd(rgdp60, na.rm = TRUE),
                                            min(rgdp60, na.rm = TRUE),
                                            max(rgdp60, na.rm = TRUE)))
  ) %>%
  tidyr::unnest(cols = everything()) %>%
  mutate(Statistic = c("Mean", "Standard Deviation", "Minimum", "Maximum")) %>%
  select(Statistic, everything())

# View the result
print(summary_table)
```


